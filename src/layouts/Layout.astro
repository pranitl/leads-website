---
import '../styles/global.css';

const {
  title = 'Austin Home Renovation Hub | Premium Home Services',
  description = 'Connect with curated specialists for landscaping and custom interior build-outs. Tell us what you need and we will match you with the right pros.',
  canonical,
  structuredData,
  pageClass,
} = Astro.props;

const siteUrl = Astro.site?.href ?? new URL('/', Astro.url).origin + '/';
const canonicalUrl = canonical ?? new URL(Astro.url.pathname, siteUrl).href;

const organizationSchema = {
  '@context': 'https://schema.org',
  '@type': 'Organization',
  name: 'Austin Home Renovation Hub',
  url: siteUrl,
  logo: new URL('/favicon.svg', siteUrl).toString(),
  contactPoint: [
    {
      '@type': 'ContactPoint',
      contactType: 'customer support',
      email: 'hello@austinhomereno.com',
    },
    {
      '@type': 'ContactPoint',
      contactType: 'partnerships',
      email: 'partners@austinhomereno.com',
    },
  ],
};

const websiteSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: 'Austin Home Renovation Hub',
  url: siteUrl,
};

const webPageSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebPage',
  name: title,
  description,
  url: Astro.url.href,
};

const baseSchemas = [organizationSchema, websiteSchema, webPageSchema];

const pageSchemas = Array.isArray(structuredData)
  ? structuredData
  : structuredData
    ? [structuredData]
    : [];

const allSchemas = [...baseSchemas, ...pageSchemas];

const ga4Id = import.meta.env.PUBLIC_GA4_ID;
const gaInlineScript = ga4Id
  ? `window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '${ga4Id}');`
  : '';
const navLinks = [
  { href: '/services', label: 'Services' },
  { href: '/locations', label: 'Locations' },
  { href: '/about', label: 'About' },
  { href: '/contact', label: 'Contact' },
];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;600;700&family=Lato:wght@400;700&family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@500;600;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;600;700&family=Lato:wght@400;700&family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@500;600;700&display=swap"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;600;700&family=Lato:wght@400;700&family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@500;600;700&display=swap"
      />
    </noscript>
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    {description && <meta name="description" content={description} />}
    <link rel="canonical" href={canonicalUrl} />
    {ga4Id && (
      <>
        <script is:inline async src={`https://www.googletagmanager.com/gtag/js?id=${ga4Id}`}></script>
        <script is:inline set:html={gaInlineScript}></script>
      </>
    )}
    {allSchemas.length > 0 && (
      <script type="application/ld+json" is:inline>{JSON.stringify(allSchemas)}</script>
    )}
  </head>
  <body class:list={[pageClass]}>
    <div class="flex min-h-screen flex-col">
      <header class="sticky top-0 z-40 border-b border-brown-forest/10 bg-cream-light/95 backdrop-blur">
        <div class="container flex items-center justify-between gap-6 py-4">
          <a href="/" class="flex items-center gap-2 font-heading text-xl font-semibold text-brown-dark">
            <span class="flex h-10 w-10 items-center justify-center rounded-full bg-brown-forest text-cream shadow-hard-sm">AR</span>
            Austin Reno Hub
          </a>
          <nav class="hidden items-center gap-1 md:flex">
            {navLinks.map((link) => (
              <a
                class="rounded-lg px-4 py-2 text-sm font-medium text-brown-body transition hover:text-oxide"
                href={link.href}
              >
                {link.label}
              </a>
            ))}
          </nav>
          <div class="flex items-center gap-3">
            <a class="btn-cta" href="#lead-form">
              Get My Quote
            </a>
          </div>
        </div>
      </header>

      <main class="flex-1">
        <slot />
      </main>

      <footer class="border-t border-brown-forest/10 bg-cream py-12">
        <div class="container grid gap-10 md:grid-cols-[2fr,1fr,1fr]">
          <div class="space-y-4">
            <a href="/" class="flex items-center gap-3 font-heading text-lg font-semibold text-brown-dark">
              <span class="flex h-10 w-10 items-center justify-center rounded-full bg-brown-forest text-cream shadow-hard-sm">AR</span>
              Austin Reno Hub
            </a>
            <p class="max-w-md text-sm text-brown-body">
              We match homeowners with specialized landscaping and interior buildout pros who understand modern, sustainable design. Submit your project and our team connects you within minutes.
            </p>
          </div>
          <div class="space-y-3">
            <h3 class="text-sm font-semibold uppercase tracking-wide text-brown-muted">Company</h3>
            <ul class="space-y-2 text-sm text-brown-body">
              <li><a class="hover:text-oxide" href="/about">About</a></li>
              <li><a class="hover:text-oxide" href="/contact">Contact</a></li>
              <li><a class="hover:text-oxide" href="/locations">Service Areas</a></li>
              <li><a class="hover:text-oxide" href="/privacy">Privacy</a></li>
              <li><a class="hover:text-oxide" href="/terms">Terms</a></li>
            </ul>
          </div>
          <div class="space-y-3">
            <h3 class="text-sm font-semibold uppercase tracking-wide text-brown-muted">Services</h3>
            <ul class="space-y-2 text-sm text-brown-body">
              <li><a class="hover:text-oxide" href="/services/landscaping">Landscaping</a></li>
              <li><a class="hover:text-oxide" href="/services/hardscaping">Hardscaping</a></li>
              <li><a class="hover:text-oxide" href="/services/closet-interior">Custom Closets</a></li>
            </ul>
          </div>
        </div>
        <div class="container mt-10 border-t border-brown-forest/10 pt-6 text-xs text-brown-muted">
          Â© {new Date().getFullYear()} Austin Reno Hub. All rights reserved.
        </div>
      </footer>
    </div>
  </body>
</html>
